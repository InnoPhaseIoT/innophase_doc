<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Unassociated Mode &mdash; InnoPhase 1.0.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Watchlog Timer" href="Example_using_Watchdog_Timer.html" />
    <link rel="prev" title="Provisioning" href="Example_using_Provisioning.html" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js "></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="../../_static/js/custom.js" defer></script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            InnoPhase
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Getting%20Started/Getting%20Started%20-%20Landing%20Page.html">Getting Started</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Hardware%20Reference/Hardware-Reference.html">Hardware-Reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Porting%20Guide/Porting-Guide.html">Porting-Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Disclaimers/Disclaimers.html">Disclaimer</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Appendix/Appendix-Landing_Page.html">Appendix</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Support/Support.html">Support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Software%20Reference/Software_Reference_Landing_Page.html">Software Reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Development%20Environments/Development%20Environments%20-%20Landing%20Page.html">Development Environments</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Tools/Tools-landing%20page.html">Tools</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../Applications%20-%20Landing%20Page.html">Applications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Applications%20-%20Landing%20Page.html#apps">Apps</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../Applications%20-%20Landing%20Page.html#examples">Examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Example_for_Analog_to_Digital_Converter.html">Analog to Digital Converter (ADC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_Audio_over_I2S.html">Audio Over I2S</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_BLE_WiFi_Bridge.html">BLE WiFi Bridge</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_Crash_handling.html">Crash Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_I2C.html">I2C</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_LPScan.html">LPS Scan</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_MQTT.html">MQTT</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_Pulse_Width_Modulation.html">Pulse Width Modulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_Radio_and_Module_Parameters.html">Radio and Module Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_Secure_Files.html">Secure Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_Socket_Wakeup.html">Socket Wakeup</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_Software_SPI_Master.html">Software SPI Master</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_using_Chip_Monitor.html">Chip Monitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_using_Filesystem.html">Filesystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_using_GPIO.html">GPIO</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_using_SNTP.html">SNTP</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_using_WiFi.html">WIFI</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_WiFi_Power_Management.html">WiFi Power Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_BLE_5_0.html">BLE 5.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_BLE_Beacons.html">BLE Beacon</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Custom_ATCMDLIB.html">Custom ATCMDLIB</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_HTTP_Client.html">HTTP Client</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_IFTTT.html">IFTTT</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Low_Power_UART.html">Low Power UART</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_mDNS.html">mDNS</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Provisioning.html">Provisioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Provisioning.html#scan-data">Scan Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Provisioning.html#configuration-data-format">Configuration Data Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Provisioning.html#service">Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Provisioning.html#characteristics">Characteristics</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Provisioning.html#application-flow">Application Flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Provisioning.html#sample-code-walkthrough">Sample Code Walkthrough</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Provisioning.html#write-the-provisioning-file-into-talaria-two-filesystem">Write the Provisioning File into Talaria TWO Filesystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Provisioning.html#programming-talaria-two-board-with-elf">Programming Talaria TWO board with ELF</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Provisioning.html#running-the-application-using-android-or-ios-app">Running the Application using Android or iOS App</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Unassociated Mode</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#topology">Topology</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wi-fi-unassociated-mode-functionalities">Wi-Fi Unassociated Mode Functionalities</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wi-fi-unassociated-mode-apis">Wi-Fi Unassociated Mode APIs</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wifi-if-create">wifi_if_create()</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wifi-if-destroy">wifi_if_destroy()</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wifi-init-scan-default">wifi_init_scan_default()</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wifi-ssid-from-bytes">wifi_ssid_from_bytes()</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wifi-set-pm">wifi_set_pm()</a></li>
<li class="toctree-l4"><a class="reference internal" href="#wifi-scan">wifi_scan()</a></li>
<li class="toctree-l4"><a class="reference internal" href="#states-and-events-of-unassociated-mode">States and Events of Unassociated Mode</a></li>
<li class="toctree-l4"><a class="reference internal" href="#unassociated-tx-procedure">Unassociated Tx Procedure</a></li>
<li class="toctree-l4"><a class="reference internal" href="#code-walkthrough">Code Walkthrough</a></li>
<li class="toctree-l4"><a class="reference internal" href="#unassociated-mode-tx-example">Unassociated mode Tx Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sample-code-walkthrough">Sample Code Walkthrough</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-the-example">Running the Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#expected-output">Expected Output</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Watchdog_Timer.html">Watchlog Timer</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_WCM_Multi_AP.html">WCM Multi AP</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Websock_Client.html">Websock Client</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Regulatory%20Notices/Regulatory%20Notices.html">FCC/ISED Regulatory Notices</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Security/Security%20-%20Landing%20Page.html">Security</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">InnoPhase</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../Applications%20-%20Landing%20Page.html">Applications</a></li>
      <li class="breadcrumb-item active">Unassociated Mode</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/Applications/2. Examples/Example_using_Unassociated_Mode.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="unassociated-mode">
<h1>Unassociated Mode<a class="headerlink" href="#unassociated-mode" title="Permalink to this heading"></a></h1>
<p>This application note describes the Wi-Fi Unassociated mode transmission
procedure. The WCM APIs used in the accompanying sample code describes
scan parameters which can be set, power management configuration and
transmission of unassociated frames to the AP.</p>
<section id="topology">
<h2>Topology<a class="headerlink" href="#topology" title="Permalink to this heading"></a></h2>
<p>Figure 1: Topology</p>
</section>
<section id="wi-fi-unassociated-mode-functionalities">
<h2>Wi-Fi Unassociated Mode Functionalities<a class="headerlink" href="#wi-fi-unassociated-mode-functionalities" title="Permalink to this heading"></a></h2>
<p>The Wi-Fi Unassociated mode contains functions for transmitting data
over the probe request frames without associating with an AP.</p>
<p>Following functionalities are achieved through these APIs:</p>
<ol class="arabic simple">
<li><p>Creating and destroying Wi-Fi interface</p></li>
<li><p>Initializing the default scan parameters</p></li>
<li><p>Disabling beacon reception</p></li>
<li><p>Setting power saving options</p></li>
<li><p>Wi-Fi probe transmission</p></li>
</ol>
<p>Accompanying sample code provides more details on achieving some of the
listed functionalities.</p>
</section>
<section id="wi-fi-unassociated-mode-apis">
<h2>Wi-Fi Unassociated Mode APIs<a class="headerlink" href="#wi-fi-unassociated-mode-apis" title="Permalink to this heading"></a></h2>
</section>
<section id="wifi-if-create">
<h2>wifi_if_create()<a class="headerlink" href="#wifi-if-create" title="Permalink to this heading"></a></h2>
<p>Creates a Wi-Fi interface with the specified operation mode.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>struct wifi_net *</p>
<p>wifi_if_create(enum wifi_opmode mode, const uint8_t *hwaddr)</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<ol class="arabic simple">
<li><p>mode: Interface operation mode as specified by wifi_opmode.</p></li>
</ol>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>enum wifi_opmode</p>
<p>{</p>
<p>WIFI_MODE_STA,</p>
<p>WIFI_MODE_P2P,</p>
<p>WIFI_MODE_HOSTAP,</p>
<p>WIFI_MODE_MONITOR,</p>
<p>WIFI_MODE_SCAN</p>
<p>}</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<ol class="arabic simple" start="2">
<li><p>hwaddr: Specifies the hardware MAC address to be used for this
interface. This parameter is NULL (or points to an invalid station
MAC address) and a random address will be generated for the
interface.</p></li>
</ol>
<p>Returns pointer to the newly created interface in the form of wifi_net.</p>
</section>
<section id="wifi-if-destroy">
<h2>wifi_if_destroy()<a class="headerlink" href="#wifi-if-destroy" title="Permalink to this heading"></a></h2>
<p>Destroys a Wi-Fi interface.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>void</p>
<p>wifi_if_destroy(struct wifi_net *net)</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<ol class="arabic simple">
<li><p>net: Pointer to a struct wifi_net created by wifi_if_create() API.</p></li>
</ol>
<p>Returns void.</p>
</section>
<section id="wifi-init-scan-default">
<h2>wifi_init_scan_default()<a class="headerlink" href="#wifi-init-scan-default" title="Permalink to this heading"></a></h2>
<p>Initializes the scan parameters with default values.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>void wifi_init_scan_default(struct wifi_scan_param *param)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<ol class="arabic simple">
<li><p>param: pointer to the Wi-Fi scan param structure.</p></li>
</ol>
<p>Returns void.</p>
</section>
<section id="wifi-ssid-from-bytes">
<h2>wifi_ssid_from_bytes()<a class="headerlink" href="#wifi-ssid-from-bytes" title="Permalink to this heading"></a></h2>
<p>Initializes SSID from a byte string.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>int wifi_ssid_from_bytes(struct wifi_ssid *ssid, const void
*ssid_bytes, size_t ssid_length)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p>This function initializes a SSID structure from a byte string. SSID is a
sequence of bytes, not always representable as a zero terminated string.
This function will always generate a zero-terminated result but treating
it as such will cause problems with SSID’s having embedded zero bytes
(although this is uncommon). If the input byte sequence is too long
(more than IEEE80211_NWID_LEN bytes), this function will truncate the
value, and return a negative result.</p>
<ol class="arabic simple">
<li><p>ssid: ssid structure to initialize.</p></li>
<li><p>ssid_bytes: pointer to SSID data.</p></li>
<li><p>ssid_length: length of ssid_bytes.</p></li>
</ol>
<p>Returns zero on success -EINVAL ssid_length exceeds IEEE80211_NWID_LEN.</p>
</section>
<section id="wifi-set-pm">
<h2>wifi_set_pm()<a class="headerlink" href="#wifi-set-pm" title="Permalink to this heading"></a></h2>
<p>Configures Wi-Fi power-save parameters.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>int wifi_pm_flags</p>
<p>wifi_set_pm(struct wifi_net *net, uint32_t listen_interval, uint32_t
traffic_tmo, uint32_t pm_flags)</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p>Initiate a network scan procedure on the specified WCM interface.</p>
<ol class="arabic simple">
<li><p>struct wifi_net *net: Pointer to wifi_net. This struct is
representing a Wi-Fi network (or interface).</p></li>
<li><p>listen_interval: Beacon listen interval.</p></li>
<li><p>traffic_tmo: Traffic timeout in milliseconds. The traffic timeout
parameter specifies the amount of time (in ms) for which the device
should stay active.</p></li>
<li><p>pm_flags: Using this parameter, following flags can be enabled:</p>
<ul class="simple">
<li><p>WIFI_PM_PS_POLL</p></li>
</ul>
</li>
</ol>
<blockquote>
<div><p>Send ps poll if a beacon was missed.</p>
</div></blockquote>
<ul class="simple">
<li><p>WIFI_PM_DYN_LISTEN_INT</p></li>
</ul>
<blockquote>
<div><p>Dynamic listen interval. Listen to each beacon if there has been
traffic recently.</p>
</div></blockquote>
<ul class="simple">
<li><p>WIFI_PM_STA_RX_NAP</p></li>
</ul>
<blockquote>
<div><p>Turn off receiver for uninteresting frames for station.</p>
</div></blockquote>
<ul class="simple">
<li><p>WIFI_PM_STA_ONLY_BROADCAST</p></li>
</ul>
<blockquote>
<div><p>Do not receive multicast frames that are not broadcast.</p>
</div></blockquote>
<ul class="simple">
<li><p>WIFI_PM_TX_PS</p></li>
</ul>
<blockquote>
<div><p>Send outgoing frames without leaving Wi-Fi power save.</p>
</div></blockquote>
<ul class="simple">
<li><p>WIFI_PM_MCAST_DONT_CARE</p></li>
</ul>
<blockquote>
<div><p>Ignore the multicast flag in beacons. Incoming broadcast ARPs or
other important broadcast/multicast traffic may be missed.</p>
</div></blockquote>
</section>
<section id="wifi-scan">
<h2>wifi_scan()<a class="headerlink" href="#wifi-scan" title="Permalink to this heading"></a></h2>
<p>Initiates a network scan procedure to send the unassociated frame (probe
request) on the specified Wi-Fi connection interface.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>int</p>
<p>wifi_scan(struct wifi_net *net, const struct wifi_scan_param
*param)</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p>Initiate a network scan procedure.</p>
<ol class="arabic simple">
<li><p>struct wifi_net *net: Pointer to wifi_net. This struct is
representing a Wi-Fi network (or interface).</p></li>
<li><p>const struct wifi_scan_param *param: Pointer to wifi_scan_param
which contains multiple parameters that tunes the behavior of the
scan operation.</p></li>
</ol>
<blockquote>
<div><p>Returns zero on success, error value otherwise.</p>
</div></blockquote>
<p>Details about struct wifi_scan_param and working of this API are
available in section 7.1.</p>
</section>
<section id="states-and-events-of-unassociated-mode">
<h2>States and Events of Unassociated Mode<a class="headerlink" href="#states-and-events-of-unassociated-mode" title="Permalink to this heading"></a></h2>
</section>
<section id="unassociated-tx-procedure">
<h2>Unassociated Tx Procedure<a class="headerlink" href="#unassociated-tx-procedure" title="Permalink to this heading"></a></h2>
<p>When the application thread calls the API wifi_scan(),the message to the
Wi-Fi stack is sent to start the scan (send probe request) with
programmed scan parameters.</p>
<p>struct wifi_scan_param contains multiple parameters that are used to
fine tune the behaviour of the scan operation.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>/** Parametes for WiFi scan operaion */</p>
<p>struct wifi_scan_param {</p>
<p>/** List of channels to scan */</p>
<p>uint8_t channel_mask[8];</p>
<p>/** Destination address and BSSID for probe requests */</p>
<p>uint8_t bssid[IEEE80211_ADDR_LEN];</p>
<p>/** Rate to use for sending probe requests */</p>
<p>rate_t txrate;</p>
<p>/** Scan for specific SSID (set to empty string for ANY). */</p>
<p>struct wifi_ssid ssid;</p>
<p>/** The amount of time (in microseconds) to stay on the channel
after</p>
<p>transmitting the probe request and listening for responses */</p>
<p>uint32_t dwelltime;</p>
<p>/** Idle time between each channel (giving other parties access to
the</p>
<p>media) */</p>
<p>uint32_t waittime;</p>
<p>/** Length of optional extra information elements included in the
probe</p>
<p>request frames */</p>
<p>size_t ie_len;</p>
<p>/** Buffer with information elements that will be inserted in each
probe</p>
<p>request frame. */</p>
<p>uint8_t ie_list[0];</p>
<p>};</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p>wifi_init_scan_default()initiates wifi_scan_param structure which is
used when scan parameter is passed as NULL which has the following
default values:</p>
<ol class="arabic simple">
<li><p>Sending an unassociated frame for a specific SSID can be performed by
initializing the SSID field. By default, it is empty and set for
scanning any SSID.</p></li>
<li><p>Sending an unassociated frame for any specific channel can be done by
initializing the channel mask. By default, it is set to 0xff and is
set for all the channels.</p></li>
<li><p>By default, dwell-time is set to 25µs, wait time to 0 and no other
additional information elements are included.</p></li>
</ol>
<p>struct wifi_netinfo holds the results and information about scanned
networks. This parameter structure is not valid for the unassociated
mode.</p>
</section>
<section id="code-walkthrough">
<h2>Code Walkthrough<a class="headerlink" href="#code-walkthrough" title="Permalink to this heading"></a></h2>
</section>
<section id="unassociated-mode-tx-example">
<h2>Unassociated mode Tx Example<a class="headerlink" href="#unassociated-mode-tx-example" title="Permalink to this heading"></a></h2>
</section>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this heading"></a></h2>
<p>The sample code in the path <em>example\unassoc\src\main.c</em> showcases
the unassociated mode transmission.</p>
</section>
<section id="sample-code-walkthrough">
<h2>Sample Code Walkthrough<a class="headerlink" href="#sample-code-walkthrough" title="Permalink to this heading"></a></h2>
<p>This example code initializes the scan parameters as default. It also
gets the boot arguments and stores it in scan parameters.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>// Allocate memory for a &#64;ref wifi_scan_param specifying the length</p>
<p>of the ie_list</p>
<p>struct wifi_scan_param *param = os_alloc(sizeof (struct</p>
<p>wifi_scan_param) + ie_len);</p>
<p>// Initiate the default scan param values</p>
<p>wifi_init_scan_default(param);</p>
<p>// Update the ie_list</p>
<p>if(ie_len &gt; 0) {</p>
<p>param-&gt;ie_len = ie_len;</p>
<p>memcpy(param-&gt;ie_list, ie_list_output, ie_len);</p>
<p>}</p>
<p>// Number of probes to send can be specified by the boot arg</p>
<p>num_probes, 0 for infinity</p>
<p>uint32_t num_probes = os_get_boot_arg_int(“num_probes”, 0);</p>
<p>interval = os_get_boot_arg_int(“interval_ms”, 1000);</p>
<p>// Specify a target bssid, defaults to ANY</p>
<p>const char *tmp;</p>
<p>tmp = os_get_boot_arg_str(“addr”);</p>
<p>if (tmp)</p>
<p>parse_macaddr(tmp, param-&gt;bssid);</p>
<p>// Specify the rate to send probes, generally 11b-&gt;11g (RATE_1 to</p>
<p>RATE_6)</p>
<p>param-&gt;txrate = os_get_boot_arg_int(“rate”, RATE_6);</p>
<p>// Specify a target SSID, defaults to ANY</p>
<p>tmp = os_get_boot_arg_str(“scan_ssid”);</p>
<p>if (tmp)</p>
<p>wifi_ssid_from_bytes(&amp;param-&gt;ssid, tmp, strlen(tmp));</p>
<p>// Enable device suspend (deep sleep) via boot argument</p>
<p>bool suspend = os_get_boot_arg_int(“suspend”, 0);</p>
<p>if (suspend == 1) {</p>
<p>os_printf(“deep sleep enabled.\n”);</p>
<p>os_suspend_enable();</p>
<p>} else {</p>
<p>os_printf(“deep sleep disabled.\n”);</p>
<p>}</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p>The following code creates the Wi-Fi interface in scan mode. It also
sets the power management feature and sends unassociated frames in a
while loop.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>struct wifi_net *net = wifi_if_create(WIFI_MODE_SCAN, NULL);</p>
<p>// Set the shortest traffic_tmo and hope to go to suspend early</p>
<p>wifi_set_pm(net, 0, 1, 0);</p>
<p>uint32_t num_probe_sent = 0;</p>
<p>callout_init(&amp;probe_callout, send_unassoc_probe);</p>
<p>os_sem_init(&amp;send_probe_sem, 0);</p>
<p>for(;;) {</p>
<p>os_printf(“[%u] Sending probe\n”, num_probe_sent);</p>
<p>int result = wifi_probe_send(net, param);</p>
<p>if(result == 0)</p>
<p>num_probe_sent++;</p>
<p>else</p>
<p>os_printf(“[%u] Failed to send probe due to error %d\n”,</p>
<p>num_probe_sent, -result);</p>
<p>start_timeout();</p>
<p>os_sem_wait(&amp;send_probe_sem);</p>
<p>if((num_probes != 0) &amp;&amp;</p>
<p>(num_probes == num_probe_sent)) {</p>
<p>os_printf(“Probe sending complete.\n”);</p>
<p>break;</p>
<p>} }</p>
<p>os_printf(“Sent %d out of %d probes.\n”, num_probe_sent,</p>
<p>num_probes);</p>
<p>wifi_if_destroy(net);</p>
<p>os_free(param);</p>
<p>while(1) {</p>
<p>os_sem_wait(&amp;send_probe_sem);</p>
<p>} }</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
</section>
<section id="running-the-example">
<h2>Running the Example<a class="headerlink" href="#running-the-example" title="Permalink to this heading"></a></h2>
<p>Program unassoc.elf <em>(freertos_sdk_x.y\examples\unassoc\bin)</em> using
the Download tool:</p>
<ol class="arabic simple">
<li><p>Launch the Download tool provided with InnoPhase Talaria TWO SDK.</p></li>
<li><p>In the GUI window:</p>
<ol class="loweralpha simple">
<li><p>Boot Target: Select the appropriate EVK from the drop-down.</p></li>
<li><p>ELF Input: Load the unassoc.elf by clicking on Select ELF File.</p></li>
<li><p>Boot Arguments: Pass the following boot arguments:</p></li>
</ol>
</li>
</ol>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>scan_ssid=InnoPhase_AE_AP,ie_list=0x11:0x02:0x3
3:0x44:0x12:0x04:0x77:0x88:0x99:0xaa:0x13:0x07:0xa0:0xa1:0xa2:0xa3:0x
a4:0xa5:0xa6,rate=0,num_probes=3,suspend=1,interval_ms=1500,verbose=1</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<blockquote>
<div><p><strong>Note</strong>: For one, two and three custom ies, refer the README file in
the following location: <em>freertos_sdk_x.y\examples\unassoc\doc</em>.</p>
</div></blockquote>
<ol class="loweralpha simple" start="4">
<li><p>Programming: Click on Prog Flash.</p></li>
</ol>
</section>
<section id="expected-output">
<h2>Expected Output<a class="headerlink" href="#expected-output" title="Permalink to this heading"></a></h2>
<p>unassoc.elf provides the following console output in different scenarios
when programmed to Talaria TWO.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Y-BOOT 208ef13 2019-07-22 12:26:54 -0500 790da1-b-7</p>
<p>ROM yoda-h0-rom-16-0-gd5a8e586</p>
<p>FLASH:PNWWWWWWAE</p>
<p>Build $Id: git-df9b9ef $</p>
<p>Flash detected. flash.hw.uuid: 39483937-3207-00b0-0064-ffffffffffff</p>
<p>Bootargs: scan_ssid=Lucy
ie_list=0x11:0x02:0x33:0x44:0x12:
0x04:0x77:0x88:0x99:0xaa:0x13:0x07:0xa0:0xa1:0xa2:0xa3:0xa4:0xa5:0xa6
rate=0 num_probes=3 suspend=1 interval_ms=1500 verbose=1</p>
<p>$App:git-6600fea</p>
<p>SDK Ver: FREERTOS_SDK_1.0</p>
<p>Un-Assoc Tx Example</p>
<p>ie_len=94</p>
<p>ie_len=19</p>
<p>Hexdump of IES, len=19</p>
<p>11 02 33 44 12 04 77 88 99 AA 13 07 A0 A1 A2 A3 | ..3D..w………</p>
<p>A4 A5 A6 | …</p>
<p>Hexdump of ie <a class="reference external" href="tag:11">tag:11</a>, len=2</p>
<p>33 44 | 3D</p>
<p>Hexdump of ie <a class="reference external" href="tag:12">tag:12</a>, len=4</p>
<p>77 88 99 AA | w…</p>
<p>Hexdump of ie <a class="reference external" href="tag:13">tag:13</a>, len=7</p>
<p>A0 A1 A2 A3 A4 A5 A6 | …….</p>
<p>deep sleep enabled.</p>
<p>[1] Sending probe.</p>
<p>[1] Probe completed.</p>
<p>[2] Sending probe.</p>
<p>[2] Probe completed.</p>
<p>[3] Sending probe.</p>
<p>[3] Probe completed.</p>
<p>Done sending probes!</p>
<p>Done</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p>Wireshark output in Figure 2 shows the 3 probe requests sent to
configured SSID for interval of 1500ms.</p>
<p><a class="reference internal" href="../../_images/image110.png"><img alt="image1" src="../../_images/image110.png" style="width: 6.29921in; height: 1.34808in;" /></a></p>
<p>Figure : Probe requests sent to configured SSID – Wireshark output</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Example_using_Provisioning.html" class="btn btn-neutral float-left" title="Provisioning" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Example_using_Watchdog_Timer.html" class="btn btn-neutral float-right" title="Watchlog Timer" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023 InnoPhase IoT, Inc. | All Rights Reserved | Proprietary &amp; Confidential.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>