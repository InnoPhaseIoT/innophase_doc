<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>mDNS &mdash; InnoPhase 1.0.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Provisioning" href="Example_using_Provisioning.html" />
    <link rel="prev" title="Low Power UART" href="Example_using_Low_Power_UART.html" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js "></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="../../_static/js/custom.js" defer></script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            InnoPhase
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Getting%20Started/Getting%20Started%20-%20Landing%20Page.html">Getting Started</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Hardware%20Reference/Hardware-Reference.html">Hardware-Reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Porting%20Guide/Porting-Guide.html">Porting-Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Disclaimers/Disclaimers.html">Disclaimer</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Appendix/Appendix-Landing_Page.html">Appendix</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Support/Support.html">Support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Software%20Reference/Software_Reference_Landing_Page.html">Software Reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Development%20Environments/Development%20Environments%20-%20Landing%20Page.html">Development Environments</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Tools/Tools-landing%20page.html">Tools</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../Applications%20-%20Landing%20Page.html">Applications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Applications%20-%20Landing%20Page.html#apps">Apps</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../Applications%20-%20Landing%20Page.html#examples">Examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Example_for_Analog_to_Digital_Converter.html">Analog to Digital Converter (ADC)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_Audio_over_I2S.html">Audio Over I2S</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_BLE_WiFi_Bridge.html">BLE WiFi Bridge</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_Crash_handling.html">Crash Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_I2C.html">I2C</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_LPScan.html">LPS Scan</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_MQTT.html">MQTT</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_Pulse_Width_Modulation.html">Pulse Width Modulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_Radio_and_Module_Parameters.html">Radio and Module Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_Secure_Files.html">Secure Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_Socket_Wakeup.html">Socket Wakeup</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_Software_SPI_Master.html">Software SPI Master</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_using_Chip_Monitor.html">Chip Monitor</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_using_Filesystem.html">Filesystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_using_GPIO.html">GPIO</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_using_SNTP.html">SNTP</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_using_WiFi.html">WIFI</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_for_WiFi_Power_Management.html">WiFi Power Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_BLE_5_0.html">BLE 5.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_BLE_Beacons.html">BLE Beacon</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Custom_ATCMDLIB.html">Custom ATCMDLIB</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_HTTP_Client.html">HTTP Client</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_IFTTT.html">IFTTT</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Low_Power_UART.html">Low Power UART</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">mDNS</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#code-walkthrough-for-mdns">Code Walkthrough for mDNS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#application-flow">Application Flow</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sample-code-walkthrough">Sample Code Walkthrough</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-the-application">Running the Application</a></li>
<li class="toctree-l4"><a class="reference internal" href="#programming-talaria-two-board-with-elf">Programming Talaria TWO board with ELF</a></li>
<li class="toctree-l4"><a class="reference internal" href="#using-the-application">Using the Application</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-bootargs-for-mdns-service-register-and-announce">Example Bootargs for mDNS Service Register and Announce</a></li>
<li class="toctree-l4"><a class="reference internal" href="#example-bootargs-for-mdns-service-discovery">Example Bootargs for mDNS Service Discovery</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Provisioning.html">Provisioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Provisioning.html#scan-data">Scan Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Provisioning.html#configuration-data-format">Configuration Data Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Provisioning.html#service">Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Provisioning.html#characteristics">Characteristics</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Provisioning.html#application-flow">Application Flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Provisioning.html#sample-code-walkthrough">Sample Code Walkthrough</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Provisioning.html#write-the-provisioning-file-into-talaria-two-filesystem">Write the Provisioning File into Talaria TWO Filesystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Provisioning.html#programming-talaria-two-board-with-elf">Programming Talaria TWO board with ELF</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Provisioning.html#running-the-application-using-android-or-ios-app">Running the Application using Android or iOS App</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Unassociated_Mode.html">Unassociated Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Watchdog_Timer.html">Watchlog Timer</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_WCM_Multi_AP.html">WCM Multi AP</a></li>
<li class="toctree-l3"><a class="reference internal" href="Example_using_Websock_Client.html">Websock Client</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Regulatory%20Notices/Regulatory%20Notices.html">FCC/ISED Regulatory Notices</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Security/Security%20-%20Landing%20Page.html">Security</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">InnoPhase</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../Applications%20-%20Landing%20Page.html">Applications</a></li>
      <li class="breadcrumb-item active">mDNS</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/Applications/2. Examples/Example_using_mDNS.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mdns">
<h1>mDNS<a class="headerlink" href="#mdns" title="Permalink to this heading"></a></h1>
<p>This document describes using the mDNS APIs provided by the mDNS module
in: freertos_sdk_x.y/components/mdns. This application demonstrates
using these APIs to advertise and discover the services on the local
network.</p>
<p>For more details regarding the features and limitations of mDNS
implementation and APIs, refer mdns_apiref.pdf.</p>
<section id="code-walkthrough-for-mdns">
<h2>Code Walkthrough for mDNS<a class="headerlink" href="#code-walkthrough-for-mdns" title="Permalink to this heading"></a></h2>
</section>
<section id="application-flow">
<h2>Application Flow<a class="headerlink" href="#application-flow" title="Permalink to this heading"></a></h2>
<p>mDNS is a protocol that provides DNS like facility to advertise and
discover services in a local area network.</p>
<p>Following are the steps:</p>
<ol class="arabic simple">
<li><p>Connects to a Wi-fi network.</p></li>
<li><p>Registers to the hostname and services.</p></li>
<li><p>Acts as a mDNS announce or discovery according to the boot arguments
passed.</p></li>
</ol>
</section>
<section id="sample-code-walkthrough">
<h2>Sample Code Walkthrough<a class="headerlink" href="#sample-code-walkthrough" title="Permalink to this heading"></a></h2>
<p>A user-defined data struct is created to store the data of the mDNS:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>#define APP_NAME “mDNS application”</p>
<p>#define APP_VERSION “2.0”</p>
<p>OS_APPINFO {.stack_size = 4096};</p>
<p>#define INPUT_PARAMETER_SSID “ssid”</p>
<p>#define INPUT_PARAMETER_PASSPHRASE “passphrase”</p>
<p>#define INPUT_PARAMETER_HOST “host”</p>
<p>#define INPUT_PARAMETER_URL “url”</p>
<p>#define INPUT_PARAMETER_PATH “path”</p>
<p>#define INPUT_PARAMETER_PORT “port”</p>
<p>#define INPUT_PARAMETER_SECURED “secured”</p>
<p>#define INPUT_PARAMETER_METHOD “method”</p>
<p>#define INPUT_PARAMETER_CA “ca_cert”</p>
<p>#define INPUT_PARAMETER_POST_LEN “post_len”</p>
<p>#define INPUT_PARAMETER_CLIENT_CERT “client_cert”</p>
<p>#define INPUT_PARAMETER_CLIENT_KEY “client_key”</p>
<p>#define INPUT_PARAMETER_TEST_ITER “test_iterations”</p>
<p>#define INPUT_PARAMETER_USE_CA_BUNDLE “use_ca_bundle”</p>
<p>#define NULL_STR “”</p>
<p>struct param_t {</p>
<p>const char *ssid;</p>
<p>const char *passphrase;</p>
<p>/* parameters for advertise */</p>
<p>const char *servicename;</p>
<p>const char *service_type;</p>
<p>const char *proto; /* 0 - UDP, 1- TCP */</p>
<p>const char *port;</p>
<p>const char *txt_key;</p>
<p>const char *txt_val;</p>
<p>const char *hostname;</p>
<p>/* Parameters for Service Discovery */</p>
<p>const char *sd_srvc_type;</p>
<p>const char *sd_srvc_proto;</p>
<p>const char *action;</p>
<p>};</p>
<p>bool wcm_connected = false;</p>
<p>struct param_t param;</p>
<p>char default_port[8];</p>
<p>char keyVal[256];</p>
<p>const char *txt_key_val[10];</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p>The following boot arguments are passed in this application:</p>
<ol class="arabic simple">
<li><p>SSID and passphrase to connect to the Wi-Fi network.</p></li>
<li><p>Hostname, service name, service type, proto, port, text key and
value.</p></li>
<li><p>SD service type and proto, and action.</p></li>
</ol>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>static int</p>
<p>parse_boot_args(void)</p>
<p>{</p>
<p>int ret = 0;</p>
<p>param.ssid= os_get_boot_arg_str(INPUT_PARAMETER_SSID);</p>
<p>param.passphrase= os_get_boot_arg_str(INPUT_PARAMETER_PASSPH);</p>
<p>param.hostname= os_get_boot_arg_str(INPUT_PARAMETER_HOST_NAME);</p>
<p>param.servicename= os_get_boot_arg_str(INPUT_PARAMETER_SRVC_NAME);</p>
<p>param.service_type= os_get_boot_arg_str(INPUT_PARAMETER_SRVC_TYPE);</p>
<p>param.proto= os_get_boot_arg_str(INPUT_PARAMETER_PROTO);</p>
<p>param.port = os_get_boot_arg_str(INPUT_PARAMETER_PORT);</p>
<p>param.txt_key = os_get_boot_arg_str(INPUT_PARAMETER_TXT_KEY);</p>
<p>param.txt_val = os_get_boot_arg_str(INPUT_PARAMETER_TXT_VAL);</p>
<p>param.sd_srvc_type =
os_get_boot_arg_str(INPUT_PARAMETER_SD_SRVC_TYPE);</p>
<p>param.sd_srvc_proto =
os_get_boot_arg_str(INPUT_PARAMETER_SD_SRVC_PROTO);</p>
<p>param.action = os_get_boot_arg_str(INPUT_PARAMETER_ACTION);</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p>To connect to a Wi-Fi network, wcm_create()API from the Wi-Fi Connection
Manager is used. Initially, the Wi-Fi network interface is created using
wcm_create().</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>h = wcm_create(NULL);</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<blockquote>
<div><p>wifi_connect_to_network()API, from components library, connects to
the Wi-Fi network using the AP credentials provided.</p>
</div></blockquote>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>rval = wifi_connect_to_network(&amp;h, WCM_CONN_WAIT_INFINITE,
&amp;wcm_connect_success);</p>
<p>if(rval &lt; 0) {</p>
<p>os_printf(”\nError: Unable to connect to network\n”);</p>
<p>return 0;</p>
<p>}</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p>Here, the data structure mdns_srvc_info_t is used to pass information
about the discovered service such as service instance, protocol, type,
port and IP address. Information is passed through the callback function
provided while calling the mdns_service_discover API from main function.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>void app_dns_sd_cb(void *data_ptr,</p>
<p>const mdns_srvc_info_t *srvinfo,</p>
<p>uint32_t status)</p>
<p>{</p>
<p>os_print
f(”\n————————————————————“);</p>
<p>os_printf(”\n[APP]%s:Discovered service info:”, __FUNCTION__);</p>
<p>os_printf(”\n\tInstance = %s \n\tservice type = %s \n\tprotocol
= %s\n\t”</p>
<p>“txt info = %s \n\tport = %d \n\tipaddr = %x\n”,</p>
<p>srvinfo-&gt;instance, srvinfo-&gt;srvc_type, srvinfo-&gt;protocol,</p>
<p>srvinfo-&gt;txtInfo, srvinfo-&gt;port, srvinfo-&gt;ipaddr);</p>
<p>os_printf(”\n”);</p>
<p>os_print
f(”\n————————————————————“);</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p>If the action parameter is set to 0, mDNS will register and advertise
the service.</p>
<p>The data structure mdns_hnreg_param_t is used to pass parameters while
registering the Host Name. Set a unique host name for a device by using
mac address. Add domain name as MDNS_LOCAL_DOMAIN and IP address in
little endian format.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>mdns_hnreg_param_t hn_reg_prm = {0};</p>
<p>hn_reg_prm.hostname = (!param.hostname)?</p>
<p>(uint8_t *)”InnophaseDev” : (uint8_t *)param.hostname;</p>
<p>hn_reg_prm.domain = (uint8_t *)MDNS_LOCAL_DOMAIN;</p>
<p>hn_reg_prm.ipaddr = ntohl(ipaddr);</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p>The function mdns_hostname_reg is used for registering the host name of
the interface.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>mdns_hostname_reg(mc, &amp;hn_reg_prm);</p>
<p>os_printf(”\n[APP]Host name Reg done”);</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p>The data structure mdns_srvreg_param_t is used to pass the parameters
while registering a service.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>mdns_srvreg_param_t srv_reg = {0};</p>
<p>srv_reg.srvc_name = (uint8_t *)param.servicename;</p>
<p>srv_reg.srvc_type = (uint8_t *)param.service_type;</p>
<p>srv_reg.srvc_proto = (!param.proto) ?</p>
<p>(uint8_t *)”_tcp”: (uint8_t *)param.proto;</p>
<p>srv_reg.port = (!param.port)? 80 : atoi(param.port);</p>
<p>srv_reg.domain = (uint8_t *)MDNS_LOCAL_DOMAIN;</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p>The function mdns_service_register is used for registering the service.
Once registered, response for any matching query will be given
internally.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>mdns_service_register(mc, &amp;srv_reg);</p>
<p>os_printf(”\n[APP]Service Reg done”);</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p>The following section provides information on how the discovery of the
service happens when the action parameter is not set to 0.</p>
<p>The data structure mdns_srvcdisc_param_t is used for passing the
parameters while discovering for service of specific type.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>os_printf(”\n[APP]Discovering Service”);</p>
<p>mdns_srvcdisc_param_t sd_param = {0};</p>
<p>sd_param.srvc_sub_type = NULL;</p>
<p>sd_param.srvc_type = (!param.sd_srvc_type)?</p>
<p>(uint8_t *)”_http”: (uint8_t *)param.sd_srvc_type;</p>
<p>sd_param.srvc_proto =(!param.sd_srvc_proto)?</p>
<p>(uint8_t *)”_tcp”: (uint8_t *)param.sd_srvc_proto;</p>
<p>sd_param.domain = (uint8_t *)MDNS_LOCAL_DOMAIN;</p>
<p>sd_param.scope = MDNS_SCOPE_IPV4_LOCAL;</p>
<p>sd_param.cb = app_dns_sd_cb;</p>
<p>mdns_service_discover(mc, &amp;sd_param);</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
</section>
<section id="running-the-application">
<h2>Running the Application<a class="headerlink" href="#running-the-application" title="Permalink to this heading"></a></h2>
</section>
<section id="programming-talaria-two-board-with-elf">
<h2>Programming Talaria TWO board with ELF<a class="headerlink" href="#programming-talaria-two-board-with-elf" title="Permalink to this heading"></a></h2>
<p>Program mdns.elf <em>(freertos_sdk_x.y/examples/mdns/bin)</em> using the
Download tool:</p>
<ol class="arabic simple">
<li><p>Launch the Download tool provided with InnoPhase Talaria TWO SDK.</p></li>
<li><p>In the GUI window:</p>
<ol class="loweralpha simple">
<li><p>Boot Target: Select the appropriate EVK from the drop-down.</p></li>
<li><p>ELF Input: Load the mdns.elf by clicking on Select ELF File.</p></li>
<li><p>AP Options: Pass the SSID and Passphrase to connect to an Access
Point.</p></li>
<li><p>Boot Arguments: Pass the appropriate boot arguments.</p></li>
<li><p>Programming: Prog RAM or Prog Flash as per requirement.</p></li>
</ol>
</li>
</ol>
</section>
<section id="using-the-application">
<h2>Using the Application<a class="headerlink" href="#using-the-application" title="Permalink to this heading"></a></h2>
<p>Following are the list of boot arguments:</p>
<ol class="arabic simple">
<li><p>ssid: SSID of the Wi-Fi network to connect to.</p></li>
<li><p>passphrase: Passphrase of the network.</p></li>
<li><p>hostname: Hostname of the device. For example: “InnoDev”.</p></li>
<li><p>service_name: Service name. For example: “Prov”.</p></li>
<li><p>service_type: Type of service. For example: “_http”.</p></li>
<li><p>proto: Protocol type. For example: “_tcp” / “_udp”.</p></li>
<li><p>port: Get/Post.</p></li>
<li><p>txt_key: “key” part of the one key-val pair of txt data.</p></li>
<li><p>txt_val: “val” part of the one key-val pair of txt data. Only one
Key-val pair can be set.</p></li>
<li><p>sd_srvc_type: Type of service to discover.</p></li>
<li><p>sd_srvc_proto: Type of protocol to discover.</p></li>
<li><p>action:</p>
<ol class="loweralpha simple">
<li><p>0 – Register and Advertise a service.</p></li>
<li><p>1 – Discover a service. The combination of sd_srvc_type and
sd_srvc_proto are used for discovering the service. Providing
both the parameters is a must for discovering a service.</p></li>
</ol>
</li>
</ol>
</section>
<section id="example-bootargs-for-mdns-service-register-and-announce">
<h2>Example Bootargs for mDNS Service Register and Announce<a class="headerlink" href="#example-bootargs-for-mdns-service-register-and-announce" title="Permalink to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ssid=&lt;ssid&gt;,passphrase=&lt;passphrase&gt;,host=Innodev, service_name =Prov,
serv
ice_type=_http,proto=_tcp,port=80,txt_key=path,txt_val=/data,action=0</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p>Console output:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Y-BOOT 208ef13 2019-07-22 12:26:54 -0500 790da1-b-7</p>
<p>ROM yoda-h0-rom-16-0-gd5a8e586</p>
<p>FLASH:PWWWWWWAE</p>
<p>Build $Id: git-e52d93e $</p>
<p>Flash detected. flash.hw.uuid: 39483937-3207-0080-0055-ffffffffffff</p>
<p>Bootargs: ssid=innotest_AP <a class="reference external" href="mailto:passphrase=inno&#37;&#52;&#48;1234">passphrase=inno<span>&#64;</span>1234</a> sd_srvc_type=_http,
sd_srvc_proto=_tcp, action=1</p>
<p>$App:git-8b301e9</p>
<p>SDK Ver: FREERTOS_SDK_1.0</p>
<p>MDNS Demo App</p>
<p>Application Information:</p>
<p>Name : MDNS application</p>
<p>Version : 1.0</p>
<p>Build Date : Aug 24 2023</p>
<p>Build Time : 15:26:32</p>
<p>Heap Available: 311 KB (318968 Bytes)</p>
<p>[APP]Bootparams:</p>
<p>hostname=&lt;null&gt;</p>
<p>port = &lt;null&gt;</p>
<p>servicename = &lt;null&gt;</p>
<p>service_type = &lt;null&gt;</p>
<p>proto = &lt;null&gt;</p>
<p>key = &lt;null&gt;</p>
<p>val = &lt;null&gt;</p>
<p>sd_service_type = _http,</p>
<p>sd_service_proto = _tcp,</p>
<p>[APP]Bootparams check done….ret = 0</p>
<p>addr e0:69:3a:00:08:38</p>
<p>network profile created for ssid: innotest_AP</p>
<p>Connecting to added network : innotest_AP</p>
<p>[1.330,481] DEAUTHENTICATED: reason 1</p>
<p>[1.740,583] CONNECT:0e:70:6c:d6:3a:62 Channel:6 rssi:-49 dBm</p>
<p>wcm_notify_cb to App Layer - WCM_NOTIFY_MSG_LINK_UP</p>
<p>wcm_notify_cb to App Layer - WCM_NOTIFY_MSG_ADDRESS</p>
<p>[1.786,814] MYIP 192.168.99.195</p>
<p>[1.786,978] IPv6 [fe80::e269:3aff:fe00:838]-link</p>
<p>wcm_notify_cb to App Layer - WCM_NOTIFY_MSG_CONNECTED</p>
<p>Connected to added network : innotest_AP</p>
<p>[APP]Starting Mdns</p>
<p>[APP]Mdns init done</p>
<p>[APP]Discovering Service</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p>Once mDNS Service Register and Announce is started, start any of the
discovery apps and scan for the services that are announced by Talaria
TWO. Following are some of the options for the user for the service
discovery:</p>
<p><strong>Option 1:</strong> Mobile application: mDNS Discovery</p>
<ol class="arabic simple">
<li><p>Install and launch the mDNS Discovery app on the mobile.</p></li>
</ol>
<blockquote>
<div><p><a class="reference internal" href="../../_images/image110.png"><img alt="image1" src="../../_images/image110.png" style="width: 3.14961in; height: 6.39128in;" /></a></p>
</div></blockquote>
<p>Figure : mDNS Discovery app</p>
<ol class="arabic simple" start="2">
<li><p>Add the service type i.e., HTTP in the search option, enable TCP
which is the proto and click on Search.</p></li>
</ol>
<p><a class="reference internal" href="../../_images/image22.png"><img alt="image2" src="../../_images/image22.png" style="width: 3.14961in; height: 6.54135in;" /></a></p>
<p>Figure : Add service type</p>
<ol class="arabic simple" start="3">
<li><p>Now the announced service from Talaria TWO can be found as shown in
Figure 3.</p></li>
</ol>
<blockquote>
<div><p><a class="reference internal" href="../../_images/image32.png"><img alt="image3" src="../../_images/image32.png" style="width: 3.14961in; height: 6.0702in;" /></a></p>
</div></blockquote>
<p>Figure : Discovered service</p>
<p><strong>Option 2</strong>: Command line on Windows OS</p>
<p>Prerequisite: Install the Bonjour Browser from the following link to run
the command line on Windows OS:
<a class="reference external" href="https://hobbyistsoftware.com/bonjourbrowser">https://hobbyistsoftware.com/bonjourbrowser</a>.</p>
<ol class="arabic simple">
<li><p>Service discovery can be done from a Windows command line, using the
dns-sd command to browse for services that are being broadcast on the
local network by Talaria TWO.</p></li>
</ol>
<blockquote>
<div><p><a class="reference internal" href="../../_images/image42.png"><img alt="image4" src="../../_images/image42.png" style="width: 5.90551in; height: 1.65893in;" /></a></p>
</div></blockquote>
<p>Figure : Service discovery from Windows command line</p>
<p><strong>Option 3</strong>: User can also use two Talaria TWO modules: One for service
register and announce from section 6.1 and one more for service
discovery from section 6.2 to load the application. On the service
discovery console, the announced service can be observed.</p>
</section>
<section id="example-bootargs-for-mdns-service-discovery">
<h2>Example Bootargs for mDNS Service Discovery<a class="headerlink" href="#example-bootargs-for-mdns-service-discovery" title="Permalink to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ssid=&lt;ssid&gt;,passphrase=&lt;passphrase&gt;, sd_srvc_type=_http,
sd_srvc_proto=_tcp, action=1</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p>Console output:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Y-BOOT 208ef13 2019-07-22 12:26:54 -0500 790da1-b-7</p>
<p>ROM yoda-h0-rom-16-0-gd5a8e586</p>
<p>FLASH:PWWWWWWAE</p>
<p>Build $Id: git-e52d93e $</p>
<p>Flash detected. flash.hw.uuid: 39483937-3207-0080-0055-ffffffffffff</p>
<p>Bootargs: ssid=innotest_AP <a class="reference external" href="mailto:passphrase=inno&#37;&#52;&#48;1234">passphrase=inno<span>&#64;</span>1234</a> host=Innodev
service_name=Prov service_type=_http proto=_tcp port=80 txt_key=path
txt_val=/data action=0</p>
<p>$App:git-8b301e9</p>
<p>SDK Ver: FREERTOS_SDK_1.0</p>
<p>MDNS Demo App</p>
<p>Application Information:</p>
<p>Name : MDNS application</p>
<p>Version : 1.0</p>
<p>Build Date : Aug 24 2023</p>
<p>Build Time : 15:26:32</p>
<p>Heap Available: 311 KB (318968 Bytes)</p>
<p>[APP]Bootparams:</p>
<p>hostname=&lt;null&gt;</p>
<p>port = 80</p>
<p>servicename = Prov</p>
<p>service_type = _http</p>
<p>proto = _tcp</p>
<p>key = path</p>
<p>val = /data</p>
<p>sd_service_type = &lt;null&gt;</p>
<p>sd_service_proto = &lt;null&gt;</p>
<p>[APP]Bootparams check done….ret = 0</p>
<p>addr e0:69:3a:00:08:38</p>
<p>network profile created for ssid: innotest_AP</p>
<p>Connecting to added network : innotest_AP</p>
<p>[0.746,137] CONNECT:0e:70:6c:d6:3a:62 Channel:6 rssi:-34 dBm</p>
<p>wcm_notify_cb to App Layer - WCM_NOTIFY_MSG_LINK_UP</p>
<p>wcm_notify_cb to App Layer - WCM_NOTIFY_MSG_ADDRESS</p>
<p>[0.823,237] MYIP 192.168.99.195</p>
<p>[0.823,400] IPv6 [fe80::e269:3aff:fe00:838]-link</p>
<p>wcm_notify_cb to App Layer - WCM_NOTIFY_MSG_CONNECTED</p>
<p>Connected to added network : innotest_AP</p>
<p>[APP]Starting Mdns</p>
<p>[APP]Mdns init done</p>
<p>[APP]Advertising Service</p>
<p>[APP]WCM interface ip addr = c363a8c0</p>
<p>[APP]Host name Reg done</p>
<p>[APP]Service Reg done</p>
<p>[APP]Hostname and Service Announce done</p>
<p>[APP]Service is Now discoverable by other devices in the N/w</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Example_using_Low_Power_UART.html" class="btn btn-neutral float-left" title="Low Power UART" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Example_using_Provisioning.html" class="btn btn-neutral float-right" title="Provisioning" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023 InnoPhase IoT, Inc. | All Rights Reserved | Proprietary &amp; Confidential.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>