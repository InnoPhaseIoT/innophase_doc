<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Procedure to Debug using GDB in Windows CMD &mdash; InnoPhase 1.0.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Procedure to Debug using GDB" href="Procedure%20to%20Debug%20using%20GDB.html" />
    <link rel="prev" title="Debugging using GDB" href="Debugging%20using%20GDB%20-%20Landing.html" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js "></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="../../_static/js/custom.js" defer></script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            InnoPhase
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Getting_Started_Landing_page.html">Getting Started</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Hardware-Reference.html">Hardware-Reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Porting-Guide.html">Porting-Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Software_Reference/Prerequisites/libusbK_driver-Zadig.html">Software Reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Development_Environments/Development_Environments.html">Development Environments</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Tools/Tools_Landing.html">Tools</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Applications/Applications-Landing_Page.html">Applications</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Regulatory%20Notices/Regulatory%20Notices.html">Regulatory Notice</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Security/Security%20-%20Landing%20Page.html">Security</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../Backend%20File%20Landing.html">Backend Files - for cross referencing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../Backend%20File%20Landing.html#cli">CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Backend%20File%20Landing.html#coredump">Coredump</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../Backend%20File%20Landing.html#debugging-using-gdb">Debugging using GDB</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Connecting%20JTAG%20and%20SWD%20to%20Talaria%20TWO%20module.html">Connecting JTAG/SWD to Talaria TWO module</a></li>
<li class="toctree-l3"><a class="reference internal" href="Debugging%20using%20GDB%20-%20Landing.html">Debugging using GDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="Debugging%20using%20GDB%20-%20Landing.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Procedure to Debug using GDB in Windows CMD</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="#openocd-setup">OpenOCD Setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gdb-multiarch">GDB-Multiarch</a></li>
<li class="toctree-l4"><a class="reference internal" href="#procedure-to-debug-using-gdb">Procedure to Debug using GDB</a></li>
<li class="toctree-l4"><a class="reference internal" href="#start-a-gdb-session">Start a GDB session</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Procedure%20to%20Debug%20using%20GDB.html">Procedure to Debug using GDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="VM%20versus%20Non%20VM%20based%20application.html">VM versus Non VM based application</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">InnoPhase</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../Backend%20File%20Landing.html">Backend Files - for cross referencing</a></li>
      <li class="breadcrumb-item active">Procedure to Debug using GDB in Windows CMD</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/Backend Files - for cross referencing/Debugging using GDB/Procedure to Debug using GDB in Windows CMD.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="procedure-to-debug-using-gdb-in-windows-cmd">
<h1>Procedure to Debug using GDB in Windows CMD<a class="headerlink" href="#procedure-to-debug-using-gdb-in-windows-cmd" title="Permalink to this heading"></a></h1>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Windows PC</p></li>
<li><p>OpenOCD setup</p></li>
<li><p>GDB-Multiarch setup</p></li>
</ol>
</section>
<section id="openocd-setup">
<h2>OpenOCD Setup<a class="headerlink" href="#openocd-setup" title="Permalink to this heading"></a></h2>
<p>To install the environment for GDB debugging in Windows, follow the
instructions described in sections: <em>Prerequisites for Eclipse</em> and <em>Add
Paths to the Environment Variable</em> of the document:
UG_Eclipse_Setup_Windows.docx
(<em>sdk_x.y\doc\user_guides\ug_eclipse_setup_windows\</em>).</p>
</section>
<section id="gdb-multiarch">
<h2>GDB-Multiarch<a class="headerlink" href="#gdb-multiarch" title="Permalink to this heading"></a></h2>
<p>MSYS2 is a collection of tools and libraries, which provides an
easy-to-use environment for building, installing and running in native
Windows software. MSYS2 allows user to install GDB-Multiarch in windows
machine.</p>
<p>Download the installer from the following link:
<a class="reference external" href="https://www.msys2.org/">https://www.msys2.org/</a><em>.</em></p>
<p>Follow the installation procedure available in the above link. After
completing the installation, click on Finish, which will create a popup
for MSYS2 CMD line interface.</p>
<p><a class="reference internal" href="../../_images/image113.png"><img alt="A screen shot of a computer Description automatically generated" src="../../_images/image113.png" style="width: 3.93701in; height: 2.50722in;" /></a></p>
<p>Figure 15: Running MSYS2</p>
<p>Run the following command in MSYS2 terminal and proceed with
installation.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>pacman -Syu</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="../../_images/image214.png"><img alt="A computer screen shot of a black screen Description automatically generated" src="../../_images/image214.png" style="width: 5.90551in; height: 3.09436in;" /></a></p>
<p>Figure 16: Installing mingw setup</p>
<p>Once the installation is complete, the window will be automatically
closed. Run MSYS2 MSYS from the Start menu and run the following command
in terminal to update the rest of the base packages.</p>
<p>Proceed with installation.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>pacman -Syu</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p>After completing the installation, run the following command to install
GDB-Multiarch:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>pacman -S –needed base-devel mingw-w64-x86_64-toolchain</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p>Enter a selection number, for GDB-Multiarch as shown in figure.</p>
<p><a class="reference internal" href="../../_images/image312.png"><img alt="A screenshot of a computer Description automatically generated" src="../../_images/image312.png" style="width: 5.90551in; height: 5.10216in;" /></a></p>
<p>Figure 17: Iinstalling gdb-multiarch</p>
<p>Add MSYS2 path in environmental variable to access GDB-Multiarch in
command line. To add path to environment variable, follow the steps
mentioned in section: <em>Add Paths to the Environment Variable</em> of the
document for MSYS2: UG_Eclipse_Setup_Windows.pdf
((<em>sdk_x.y\doc\user_guides\ug_eclipse_setup_windows\</em>).</p>
<p><a class="reference internal" href="../../_images/image412.png"><img alt="A screenshot of a computer program Description automatically generated" src="../../_images/image412.png" style="width: 3.93701in; height: 3.74277in;" /></a></p>
<p>Figure 18: Adding environment variable</p>
</section>
<section id="procedure-to-debug-using-gdb">
<h2>Procedure to Debug using GDB<a class="headerlink" href="#procedure-to-debug-using-gdb" title="Permalink to this heading"></a></h2>
<p>Following is the procedure to debug the VM-based applications using GDB:</p>
<ol class="arabic simple">
<li><p>Open the SDK folder in windows command line and type the following
command to start OpenOCD:</p></li>
</ol>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>openocd -s .\conf -f ftdi.cfg -f t2.cfg</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p>Console output:</p>
<p><a class="reference internal" href="../../_images/image512.png"><img alt="image1" src="../../_images/image512.png" style="width: 5.90551in; height: 3.0884in;" /></a></p>
<p>Figure 19: Running Openocd in windows CMD</p>
<ol class="arabic simple" start="2">
<li><p>Use the Download Tool to flash the virtual image from the SDK
directory.</p></li>
</ol>
<p>For example: Consider wifi_connect.elf.</p>
<p><strong>Note</strong>: For the GDB to work, ELF needs to be loaded. By default, the
SDK package contains ELF files in the bin folder (which are stripped ELF
files). Hence, the user needs to build the sample application, generate
the ELF file (by default, the ELF gets generated in the out folder) and
load this ELF for debugging.</p>
<p>For building in windows, follow the steps described in section:
<em>Building Application in Eclipse</em> of the document:
UG_Eclipse_Setup_Windows.pdf
((<em>sdk_x.y\doc\user_guides\ug_eclipse_setup_windows\</em>).</p>
<p>Execute the make for using_wifi example application
(<em>sdk_x.y\examples\using_wifi</em>) to generate the ELFs under the out
folder.</p>
<p><a class="reference internal" href="../../_images/image66.png"><img alt="A screen shot of a computer screen Description automatically generated" src="../../_images/image66.png" style="width: 6.29921in; height: 5.27757in;" /></a></p>
<p>Figure 20: Running make command in windows CMD</p>
<p>.gdbinit initialization file contains the information on Talaria TWO’s
memory and the required scripts of the GDB sources. gdbinit file is
present under the <em>apps\</em> folder. To start the GDB session,
gdb-multiarch should be started from this folder.</p>
<p>Manual method of configuring the gdbinit file:</p>
<p>If there are any warnings as shown in Figure 6, the gdb-multiarch will
not work for GDB commands. Hence, create a file named gdbinit in the
home directory to allow auto-load.</p>
<p><a class="reference internal" href="../../_images/image73.png"><img alt="A computer screen shot of a program Description automatically generated" src="../../_images/image73.png" style="width: 7.08661in; height: 4.57553in;" /></a></p>
<p>Figure 21: Warning for .gdbinit file</p>
<p>In the created gdbinit file, add the following path:</p>
<p>add-auto-load-safe-path
C:\Users\innop\Music\sdk_2.5alpha\apps\.gdbinit</p>
<p><a class="reference internal" href="../../_images/image83.png"><img alt="A close-up of a computer screen Description automatically generated" src="../../_images/image83.png" style="width: 5.90551in; height: 0.82103in;" /></a></p>
<p>Figure 22: Configuring the gdbinit file</p>
</section>
<section id="start-a-gdb-session">
<h2>Start a GDB session<a class="headerlink" href="#start-a-gdb-session" title="Permalink to this heading"></a></h2>
<p>In a separate terminal, run the following command from the
<em>sdk_x.y\apps</em> folder. In this directory, there is a .gdbinit file that
configures the GDB. Here, the RAM portion of the ELF gets loaded.</p>
<p><a class="reference internal" href="../../_images/image93.png"><img alt="image2" src="../../_images/image93.png" style="width: 5.90551in; height: 2.31644in;" /></a></p>
<p>Figure 23 Running GDB</p>
<ol class="arabic simple">
<li><p>Connect to OpenOCD by running ocd in the GDB prompt.</p></li>
</ol>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ocd</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<ol class="arabic simple" start="2">
<li><p>Set a break point at main:</p></li>
</ol>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>b main</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<ol class="arabic simple" start="3">
<li><p>Run the application by executing:</p></li>
</ol>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>R</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<ol class="arabic simple" start="4">
<li><p>Information on the break points set can be seen by issuing:</p></li>
</ol>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>info b</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<ol class="arabic simple" start="5">
<li><p>A break point at a line number of a particular source file can be set
using:</p></li>
</ol>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>b &lt;filename&gt;: &lt;linenum&gt;</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<ol class="arabic simple" start="6">
<li><p>If the line to be executed is a function call, GDB will step into
that function and start executing its code one line at a time.</p></li>
</ol>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>s</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<ol class="arabic simple" start="7">
<li><p>If the entire function needs to be executed with one key press, type
next or n.</p></li>
</ol>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>next</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<ol class="arabic simple" start="8">
<li><p>Continue running the program (after stopping, for example at a
breakpoint).</p></li>
</ol>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>continue</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<ol class="arabic simple" start="9">
<li><p>Step out is the operation that resumes execution after the function
the program is executing terminates. The debugger will stop at the
statement after the function call.</p></li>
</ol>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>finish</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p>Example 1: Following is the output while debugging the wifi_connect.elf
using GDB:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>(gdb) ocd</p>
<p>warning: A handler for the OS ABI “Windows” is not built into this
configuration</p>
<p>of GDB. Attempting to continue with the default armv7 settings.</p>
<p>0x00023f36 in ?? ()</p>
<p>(gdb) b main</p>
<p>Breakpoint 1 at 0x150e04: file src/wifi_connect.c, line 79.</p>
<p>Note: automatically using hardware breakpoints for read-only
addresses.</p>
<p>(gdb) R</p>
<p>JTAG tap: talaria_two.cpu tap/device found: 0x4ba00477 (mfg: 0x23b
(ARM Ltd.), part: 0xba00, ver: 0x4)</p>
<p>target halted due to debug-request, current mode: Thread</p>
<p>xPSR: 0x01000000 pc: 0x00020f90 msp: 0x00041a78</p>
<p>Loading section .text, size 0x13778 lma 0x42000</p>
<p>Loading section .data, size 0x520 lma 0x55778</p>
<p>Loading section .virt0, size 0x10a28 lma 0x2000000</p>
<p>Loading section .virt1, size 0x17c98 lma 0x3000000</p>
<p>Loading section .virt2, size 0x22824 lma 0x4000000</p>
<p>Loading section .virt3, size 0x628 lma 0x5000000</p>
<p>Loading section .virt4, size 0x5704 lma 0x6000000</p>
<p>Loading section .virt5, size 0x2ec lma 0x7000000</p>
<p>Start address 0x00047d00, load size 412564</p>
<p>Transfer rate: 71 KB/sec, 13308 bytes/write.</p>
<p>Program received signal SIGTRAP, Trace/breakpoint trap.</p>
<p>shutdown () at arm/entry.S:196</p>
<p>196 arm/entry.S: No such file or directory.</p>
<p>(gdb) info b</p>
<p>Num Type Disp Enb Address What</p>
<p>1 breakpoint keep y 0x00150e04 in main at src/wifi_connect.c:79</p>
<p>(gdb) del 1</p>
<p>(gdb) info b</p>
<p>No breakpoints or watchpoints.</p>
<p>(gdb) b main.c:29</p>
<p>Breakpoint 2 at 0x112704: file core/main.c, line 30.</p>
<p>(gdb) R</p>
<p>JTAG tap: talaria_two.cpu tap/device found: 0x4ba00477 (mfg: 0x23b
(ARM Ltd.), part: 0xba00, ver: 0x4)</p>
<p>target halted due to debug-request, current mode: Thread</p>
<p>xPSR: 0x01000000 pc: 0x00020f90 msp: 0x00041a78</p>
<p>Loading section .text, size 0x13778 lma 0x42000</p>
<p>Loading section .data, size 0x520 lma 0x55778</p>
<p>Loading section .virt0, size 0x10a28 lma 0x2000000</p>
<p>Loading section .virt1, size 0x17c98 lma 0x3000000</p>
<p>Loading section .virt2, size 0x22824 lma 0x4000000</p>
<p>Loading section .virt3, size 0x628 lma 0x5000000</p>
<p>Loading section .virt4, size 0x5704 lma 0x6000000</p>
<p>Loading section .virt5, size 0x2ec lma 0x7000000</p>
<p>Start address 0x00047d00, load size 412564</p>
<p>Transfer rate: 71 KB/sec, 13308 bytes/write.</p>
<p>Program received signal SIGTRAP, Trace/breakpoint trap.</p>
<p>shutdown () at arm/entry.S:196</p>
<p>196 in arm/entry.S</p>
<p>(gdb)</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Debugging%20using%20GDB%20-%20Landing.html" class="btn btn-neutral float-left" title="Debugging using GDB" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Procedure%20to%20Debug%20using%20GDB.html" class="btn btn-neutral float-right" title="Procedure to Debug using GDB" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023 InnoPhase IoT, Inc. | All Rights Reserved | Proprietary &amp; Confidential.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>