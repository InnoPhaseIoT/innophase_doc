<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FOTA Capabilities (Wi-Fi) &mdash; InnoPhase 1.0.0 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../../../../about.html" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Set-up &amp; Usage" href="../6.%20UseCases/1.%20Usecases%20-%20Landing%20Page.html" />
    <link rel="prev" title="Socket Command Responses" href="../4.%20Command%20Response%20Description/Command%20Response%20Description.html" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js "></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="../../../../_static/js/custom.js" defer></script>

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            InnoPhase
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Getting%20Started/Getting%20Started%20-%20Landing%20Page.html">Getting Started</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Hardware%20Reference/Hardware-Reference.html">Hardware-Reference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Porting%20Guide/Porting-Guide.html">Porting-Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Disclaimers/Disclaimers.html">Disclaimer</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Appendix/Appendix-Landing_Page.html">Appendix</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Support/Support.html">Support</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../Software_Reference_Landing_Page.html">Software Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../Software_Reference_Landing_Page.html#libraries">Libraries</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../Software_Reference_Landing_Page.html#solutions">Solutions</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../Solutions%20-%20Landing%20Page.html">AT Commands</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../ATCommands_Landing_Page.html">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ATCommands_Landing_Page.html#set-up-and-usage">Set-up and Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ATCommands_Landing_Page.html#at-commands">AT Commands</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ATCommands_Landing_Page.html#commands-response-description">Commands response Description</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../ATCommands_Landing_Page.html#fota-configuration-and-environment-set-up">FOTA Configuration and Environment Set-up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ATCommands_Landing_Page.html#usecases">UseCases</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../Solutions%20-%20Landing%20Page.html#stw-multi-proto">STW Multi-Proto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../Solutions%20-%20Landing%20Page.html#dual-stack">Dual stack</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../Software_Reference_Landing_Page.html#cloud-frameworks">Cloud Frameworks</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Development%20Environments/Development%20Environments%20-%20Landing%20Page.html">Development Environments</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Tools/Tools-landing%20page.html">Tools</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Applications/Applications%20-%20Landing%20Page.html">Applications</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Regulatory%20Notices/Regulatory%20Notices.html">FCC/ISED Regulatory Notices</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../Security/Security%20-%20Landing%20Page.html">Security</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../about.html">About</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">InnoPhase</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../Software_Reference_Landing_Page.html">Software Reference</a></li>
          <li class="breadcrumb-item"><a href="../../Solutions%20-%20Landing%20Page.html">AT Commands</a></li>
          <li class="breadcrumb-item"><a href="../ATCommands_Landing_Page.html">Prerequisites</a></li>
      <li class="breadcrumb-item active">FOTA Capabilities (Wi-Fi)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/Software Reference/3. Solutions/1. AT Commands/5. FOTA Configuration and Environment Set-up/FOTA Configuration and Environment Set-up.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="fota-capabilities-wi-fi">
<h1>FOTA Capabilities (Wi-Fi)<a class="headerlink" href="#fota-capabilities-wi-fi" title="Permalink to this heading"></a></h1>
<ol class="arabic simple">
<li><p>FOTA over HTTP/HTTPS</p></li>
<li><p>Image download from Cloud or any HTTP/web server</p></li>
<li><p>Two copy solution. Backup copy of the correct firmware always exists.</p></li>
<li><p>Image integrity check using sha256 hash.</p></li>
<li><p>Error handling and recovery:</p></li>
</ol>
<p>If any error occurs during downloading the image or updating the
configuration files (part.json/boot.json/fota_config.json), the device
will remain in the current image. If a reboot happens (due to issues
like power failure) during an image download or configuration files
upgrade, the device will boot with the current image.</p>
<ol class="arabic simple" start="6">
<li><p>JSON based configuration</p></li>
</ol>
<p>Have a fota_config.json file in the device. This file will be present in
the AT command application package (binaries/product/at/root_fs/root).
This file will have the necessary information to fetch an updated (new)
version of the fota_config.json file in the server. Hence, to start
with, there will be two fota_config.json files. One that is in the
device rootfs is referred to as the local copy, the other at the server
is referred to as the remote copy.</p>
<p>The remote fota_config.json in the sever will have bumped-up versions of
package_version and version under firmware. These versions in the remote
config file will be more than that in the local config file.</p>
<p>The remote fota_config.json file at the server will have necessary
information to download the firmware.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>{</p>
<p>“package_version” : “3.0”,</p>
<p>“files” : [</p>
<p>{</p>
<p>“type” : “configuration”,</p>
<p>“name” : “fota.config”,</p>
<p>“protocol” : “http”,</p>
<p>“hostname” : “192.168.1.202”,</p>
<p>“port” : 80,</p>
<p>“secured” : 0,</p>
<p>“uri” : “xxx/fota_config_new.json”</p>
<p>},</p>
<p>{</p>
<p>“type” : “firmware”,</p>
<p>“name” : “atcmd”,</p>
<p>“version” : “3.0”,</p>
<p>“protocol” : “http”,</p>
<p>“hostname” : “192.168.1.202”,</p>
<p>“port” : 80,</p>
<p>“secured” : 0,</p>
<p>“uri” : “/xxx/t2_atcmds.elf”</p>
<p>}</p>
<p>]</p>
<p>}</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<p>On booting, after at+fota=1 is issued, the device refers to the
configuration section of the local config file, downloads the new
configuration file from the server and checks if an updated package is
available. Firmware downloaded in a higher version package is available.</p>
</section>
<section id="triggering-fota-operation">
<h1>Triggering FOTA Operation<a class="headerlink" href="#triggering-fota-operation" title="Permalink to this heading"></a></h1>
<p>After the Wi-Fi connection is established, (at+wcon=ssid,passphrase),
execute at+fota=1 command. This will trigger the FOTA.</p>
</section>
<section id="image-integrity-using-hash">
<h1>Image Integrity Using Hash<a class="headerlink" href="#image-integrity-using-hash" title="Permalink to this heading"></a></h1>
<p>If hash is present for firmware, in the remote fota_config.json, then
image integrity is checked.</p>
<ol class="arabic simple">
<li><p>Creating hash (in ubuntu VM): $sha256sum &lt;elf file&gt;</p></li>
</ol>
<p>For example:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Freertos_sdk_x.y/binaries/product/at/bin$ sha256sum t2_atcmds.elf</p>
<p>0200ac047cf0bff69d9b71a12144d1bec088aad865bb17484605f305709fd1f2
t2_atcmds.elf</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
<ol class="arabic simple" start="2">
<li><p>Copy the output string to fota_config_new.json to update the hash.
Following is a remote fota_config.json with hash:</p></li>
</ol>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>{</p>
<p>“package_version” : “3.0”,</p>
<p>“files” : [</p>
<p>{</p>
<p>“type” : “configuration”,</p>
<p>“name” : “fota.config”,</p>
<p>“protocol” : “http”,</p>
<p>“hostname” : “192.168.1.202”,</p>
<p>“port” : 80,</p>
<p>“secured” : 0,</p>
<p>“uri” : “/<strong>xxx</strong>/fota_config_new.json”</p>
<p>},</p>
<p>{</p>
<p>“type” : “firmware”,</p>
<p>“name” : “atcmd”,</p>
<p>“version” : “3.0”,</p>
<p>“protocol” : “http”,</p>
<p>“hostname” : “192.168.1.202”,</p>
<p>“port” : 80,</p>
<p>“secured” : 0,</p>
<p>“uri” : “/xxx/t2_atcmds.elf”</p>
<p>“hash” :
“0200ac047cf0bff69d9b71a12144d1bec088aad865bb17484605f305709fd1f2”</p>
<p>}</p>
<p>]</p>
<p>}</p>
</th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
</tr>
</tbody>
</table>
</section>
<section id="json-file-validation">
<h1>JSON File Validation<a class="headerlink" href="#json-file-validation" title="Permalink to this heading"></a></h1>
<p><strong>Note</strong>:</p>
<ol class="arabic simple">
<li><p>No blank lines should be present in the json files.</p></li>
<li><p>Ensure that any json file is validated after any change to it using
offline/online tools. One of the online tools to accomplish this is:
<a class="reference external" href="http://json.parser.online.fr/">http://json.parser.online.fr/</a>.</p></li>
</ol>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../4.%20Command%20Response%20Description/Command%20Response%20Description.html" class="btn btn-neutral float-left" title="Socket Command Responses" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../6.%20UseCases/1.%20Usecases%20-%20Landing%20Page.html" class="btn btn-neutral float-right" title="Set-up &amp; Usage" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023 InnoPhase IoT, Inc. | All Rights Reserved | Proprietary &amp; Confidential.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>